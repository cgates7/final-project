[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Fly Balls Listed at all 30 MLB Ballparks",
    "section": "",
    "text": "# ==============================================================================\n# 1. SETUP & SEASON DATA FETCHING (CHUNKING)\n# ==============================================================================\nif (!require(\"pacman\")) install.packages(\"pacman\")\n\nLoading required package: pacman\n\npacman::p_load(tidyverse, plotly, janitor, stringr)\n\n# Function to fetch a specific date range\nfetch_chunk &lt;- function(start_date, end_date) {\n  url &lt;- paste0(\n    \"https://baseballsavant.mlb.com/statcast_search/csv\",\n    \"?all=true&type=details\",\n    \"&game_date_gt=\", start_date,\n    \"&game_date_lt=\", end_date,\n    \"&player_type=batter\"\n  )\n  message(\"Downloading: \", start_date, \" to \", end_date)\n  tryCatch({\n    read.csv(url, stringsAsFactors = FALSE) %&gt;% janitor::clean_names() %&gt;% as_tibble()\n  }, error = function(e) { message(\"Error in chunk; skipping.\"); return(tibble()) })\n}\n\n# Master function to get the WHOLE 2024 SEASON\nget_full_season_data &lt;- function() {\n  # Define monthly chunks to avoid hitting row limits/timeouts\n  date_ranges &lt;- list(\n    c(\"2024-03-28\", \"2024-04-30\"),\n    c(\"2024-05-01\", \"2024-05-31\"),\n    c(\"2024-06-01\", \"2024-06-30\"),\n    c(\"2024-07-01\", \"2024-07-31\"),\n    c(\"2024-08-01\", \"2024-08-31\"),\n    c(\"2024-09-01\", \"2024-09-29\")\n  )\n  \n  # Loop and bind\n  all_data &lt;- map_dfr(date_ranges, ~fetch_chunk(.x[1], .x[2]))\n  return(all_data)\n}\n\n# EXECUTE DOWNLOAD (This may take 1-2 minutes)\nstatcast_data &lt;- get_full_season_data()\n\nDownloading: 2024-03-28 to 2024-04-30\n\n\nDownloading: 2024-05-01 to 2024-05-31\n\n\nDownloading: 2024-06-01 to 2024-06-30\n\n\nDownloading: 2024-07-01 to 2024-07-31\n\n\nDownloading: 2024-08-01 to 2024-08-31\n\n\nDownloading: 2024-09-01 to 2024-09-29\n\n# ==============================================================================\n# 2. STADIUM GEOMETRY DATABASE\n# ==============================================================================\nstadium_dims &lt;- tibble(\n  team = c(\"ARI\",\"ATL\",\"BAL\",\"BOS\",\"CHC\",\"CWS\",\"CIN\",\"CLE\",\"COL\",\"DET\",\n           \"HOU\",\"KC\",\"LAA\",\"LAD\",\"MIA\",\"MIL\",\"MIN\",\"NYM\",\"NYY\",\"OAK\",\n           \"PHI\",\"PIT\",\"SD\",\"SEA\",\"SF\",\"STL\",\"TB\",\"TEX\",\"TOR\",\"WSH\"),\n  # Left, Left-Center, Center, Right-Center, Right\n  d_lf = c(330, 335, 333, 310, 355, 330, 328, 325, 347, 342, \n           315, 330, 330, 330, 344, 344, 339, 335, 318, 330, \n           329, 325, 334, 331, 339, 336, 315, 329, 328, 336),\n  d_lc = c(374, 385, 384, 379, 375, 375, 379, 370, 390, 370, \n           362, 385, 387, 375, 386, 371, 377, 370, 399, 375, \n           374, 383, 375, 378, 399, 375, 370, 372, 375, 377),\n  d_cf = c(407, 400, 400, 390, 400, 400, 404, 400, 415, 420, \n           409, 410, 396, 395, 407, 400, 404, 408, 408, 400, \n           401, 399, 396, 401, 391, 400, 404, 408, 400, 402),\n  d_rc = c(374, 375, 373, 420, 375, 375, 370, 375, 375, 365, \n           373, 385, 370, 375, 392, 374, 367, 370, 385, 375, \n           369, 375, 375, 381, 415, 375, 370, 374, 375, 370),\n  d_rf = c(330, 325, 318, 302, 353, 335, 325, 325, 350, 330, \n           326, 330, 330, 330, 335, 345, 328, 330, 314, 330, \n           330, 320, 322, 326, 309, 335, 322, 326, 328, 335)\n)\n\nget_stadium_poly &lt;- function(team_code) {\n  s &lt;- stadium_dims %&gt;% filter(team == team_code)\n  if(nrow(s) == 0) return(NULL)\n  ref &lt;- data.frame(\n    angle = c(-45, -22.5, 0, 22.5, 45),\n    dist  = c(s$d_lf, s$d_lc, s$d_cf, s$d_rc, s$d_rf)\n  ) %&gt;% mutate(rad=angle*pi/180, x=dist*sin(rad), y=dist*cos(rad))\n  return(as.data.frame(spline(ref$x, ref$y, n = 100)))\n}\n\n# ==============================================================================\n# 3. CLEANING & MODELING\n# ==============================================================================\nclean_data &lt;- statcast_data %&gt;%\n  # Filter for relevant events\n  filter(\n    events %in% c(\"field_out\", \"single\", \"double\", \"triple\", \"home_run\", \"sac_fly\"),\n    !bb_type %in% c(\"ground_ball\", \"popup\"), # Remove obvious infield plays\n    !is.na(hit_distance_sc), !is.na(launch_speed), !is.na(launch_angle)\n  ) %&gt;%\n  # Optional: Downsample if plot crashes (currently set to 100% data)\n  sample_frac(1) %&gt;% \n  mutate(\n    fielder_raw = str_extract(des, \"(?&lt;=fielder\\\\s)[^.,]+\"),\n    fielder_name = str_trim(fielder_raw),\n    is_caught = ifelse(events %in% c(\"field_out\", \"sac_fly\"), 1, 0),\n    \n    spray_angle = atan((hc_x - 125.42) / (198.27 - hc_y)) * 180 / pi,\n    raw_x = (hc_x - 125.42) * 2.5,\n    raw_y = (198.27 - hc_y) * 2.5,\n    angle_deg = atan2(raw_x, raw_y) * 180 / pi\n  )\n\n# Global Catch Model\ncatch_model &lt;- glm(is_caught ~ launch_speed + launch_angle + hit_distance_sc + abs(spray_angle), \n                   data = clean_data, family = \"binomial\")\nclean_data$predicted_prob &lt;- predict(catch_model, clean_data, type = \"response\")\n\n# ==============================================================================\n# 4. BUILDING THE PLOT (WITH SNAPPING)\n# ==============================================================================\nteams_with_data &lt;- sort(unique(clean_data$home_team))\nteams_with_geom &lt;- unique(stadium_dims$team)\nvalid_teams &lt;- intersect(teams_with_data, teams_with_geom)\n\nif(length(valid_teams) == 0) stop(\"No matching teams found in data.\")\n\nfig &lt;- plot_ly()\ninfield &lt;- data.frame(x = c(0, 63, 0, -63, 0), y = c(0, 63, 126, 63, 0))\nvisibility_list &lt;- list()\n\nfor(i in seq_along(valid_teams)) {\n  t &lt;- valid_teams[i]\n  \n  # A. Geometry\n  s_geom &lt;- stadium_dims %&gt;% filter(team == t)\n  poly_t &lt;- get_stadium_poly(t)\n  \n  # Fence Lookup Function\n  ref_pts &lt;- data.frame(\n    angle = c(-45, -22.5, 0, 22.5, 45), \n    dist = c(s_geom$d_lf, s_geom$d_lc, s_geom$d_cf, s_geom$d_rc, s_geom$d_rf)\n  )\n  get_fence_dist &lt;- approxfun(ref_pts$angle, ref_pts$dist, rule = 2)\n  \n  # B. Data Processing (Team Specific)\n  data_t &lt;- clean_data %&gt;% \n    filter(home_team == t) %&gt;%\n    mutate(\n      catch_prob = ifelse(events == \"home_run\", 0, predicted_prob),\n      \n      # 1. Snap Foul Balls\n      is_fair_hit = events %in% c(\"single\", \"double\", \"triple\"),\n      fixed_angle = case_when(\n        is_fair_hit & angle_deg &gt; 45 ~ 44,\n        is_fair_hit & angle_deg &lt; -45 ~ -44,\n        TRUE ~ angle_deg\n      ),\n      \n      # 2. Snap Fake Homers\n      current_dist = sqrt(raw_x^2 + raw_y^2),\n      max_dist = get_fence_dist(fixed_angle),\n      final_dist = case_when(\n        events != \"home_run\" & current_dist &gt;= max_dist ~ max_dist - 5,\n        TRUE ~ current_dist\n      ),\n      \n      coord_x = final_dist * sin(fixed_angle * pi / 180),\n      coord_y = final_dist * cos(fixed_angle * pi / 180),\n      \n      # 3. Hover Info\n      display_fielder = ifelse(is_caught == 1 & !is.na(fielder_name), fielder_name, \"N/A\"),\n      hover_txt = paste0(\n        \"&lt;b&gt;Batter:&lt;/b&gt; \", player_name, \"&lt;br&gt;\",\n        \"&lt;b&gt;Event:&lt;/b&gt; \", events, \"&lt;br&gt;\",\n        \"&lt;b&gt;Caught By:&lt;/b&gt; \", display_fielder, \"&lt;br&gt;\",\n        \"------------------&lt;br&gt;\",\n        \"&lt;b&gt;Exit Velo:&lt;/b&gt; \", round(launch_speed, 1), \" mph&lt;br&gt;\",\n        \"&lt;b&gt;Launch Angle:&lt;/b&gt; \", round(launch_angle, 1), \"°&lt;br&gt;\",\n        \"&lt;b&gt;Distance:&lt;/b&gt; \", round(hit_distance_sc, 0), \" ft&lt;br&gt;\",\n        \"&lt;b&gt;Catch Prob:&lt;/b&gt; \", round(catch_prob * 100, 1), \"%\"\n      )\n    ) %&gt;%\n    # Filter out routine short fly balls (&lt; 90% catch prob) to keep plot performant\n    filter(coord_y &gt; 50, catch_prob &lt; 0.90)\n  \n  if(nrow(data_t) == 0) data_t &lt;- data.frame(coord_x=0, coord_y=0, hover_txt=\"\", catch_prob=0)[0,]\n\n  is_visible &lt;- (i == 1)\n  \n  # C. Add Traces\n  # Trace 1: Grass\n  fig &lt;- fig %&gt;% add_polygons(\n    x = c(0, poly_t$x, 0), y = c(0, poly_t$y, 0),\n    fillcolor = \"#35682d\", opacity = 0.8, line = list(color = \"white\", width = 2),\n    name = paste(t, \"Field\"), visible = is_visible, hoverinfo = \"skip\"\n  )\n  \n  # Trace 2: Infield\n  fig &lt;- fig %&gt;% add_polygons(\n    data = infield, x = ~x, y = ~y,\n    fillcolor = \"#8b4513\", line = list(color = \"black\"),\n    name = \"Infield\", visible = is_visible, hoverinfo = \"skip\"\n  )\n  \n  # Trace 3: Data Points\n  fig &lt;- fig %&gt;% add_markers(\n    x = data_t$coord_x, \n    y = data_t$coord_y,\n    text = data_t$hover_txt,\n    hoverinfo = \"text\",\n    marker = list(\n      size = 5, # Slightly smaller dots for dense data\n      line = list(color = \"white\", width = 0.2),\n      color = data_t$catch_prob,\n      colorscale = list(c(0, \"green\"), c(0.5, \"yellow\"), c(1, \"red\")),\n      cmin = 0, cmax = 1,\n      colorbar = list(title = \"Catch Prob\")\n    ),\n    name = paste(t, \"Balls\"), visible = is_visible\n  )\n  \n  vis_vec &lt;- rep(FALSE, length(valid_teams) * 3)\n  vis_vec[((i-1)*3 + 1):((i-1)*3 + 3)] &lt;- TRUE\n  visibility_list[[i]] &lt;- list(method = \"restyle\", args = list(\"visible\", vis_vec), label = t)\n}\n\nfig &lt;- fig %&gt;% layout(\n  title = \"2024 MLB Fly Balls (Full Season)\",\n  xaxis = list(visible = FALSE, range = c(-250, 250), fixedrange=TRUE),\n  yaxis = list(visible = FALSE, range = c(0, 480), fixedrange=TRUE),\n  showlegend = FALSE,\n  plot_bgcolor = \"#f0f0f0\",\n  updatemenus = list(list(y = 1.1, x = 0.1, buttons = visibility_list))\n)\n\nfig"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About Me",
    "section": "",
    "text": "My name is Collin Gates, and I am a 2nd year student at New College of Florida. This website is my final project for the “Techne” ISP with Preceptor David Kane.\nThis project is an analysis of catch probabilities during the 2024 MLB season, which includes 50% of all fly balls hit throughout the year. This includes around 40,000 points of data, which all include catch probability, exit velocity, launch angle, distance traveled, batter, and the player who caught the fly ball (if caught)."
  },
  {
    "objectID": "final.analysis.html",
    "href": "final.analysis.html",
    "title": "Catch Probability Analysis",
    "section": "",
    "text": "catch data:\n\n\nDownloading Statcast data... this may take a moment.\n\n\n[1] \"Success! Data loaded: 2246 plays found.\"\n\n\n# A tibble: 6 × 119\n  pitch_type game_date  release_speed release_pos_x release_pos_z player_name   \n  &lt;chr&gt;      &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;         \n1 SI         2024-06-07          94            0.35          5.74 Pillar, Kevin \n2 ST         2024-06-07          85.1         -2.08          5.67 Santana, Carl…\n3 SI         2024-06-07          95.1          3.5           5.49 Bote, David   \n4 SI         2024-06-07          93           -2.99          5.49 Walker, Chris…\n5 CH         2024-06-07          87.6          3.5           5.55 Swanson, Dans…\n6 CU         2024-06-07          82.9         -2.08          5.46 Duvall, Adam  \n# ℹ 113 more variables: batter &lt;int&gt;, pitcher &lt;int&gt;, events &lt;chr&gt;,\n#   description &lt;chr&gt;, spin_dir &lt;lgl&gt;, spin_rate_deprecated &lt;lgl&gt;,\n#   break_angle_deprecated &lt;lgl&gt;, break_length_deprecated &lt;lgl&gt;, zone &lt;int&gt;,\n#   des &lt;chr&gt;, game_type &lt;chr&gt;, stand &lt;chr&gt;, p_throws &lt;chr&gt;, home_team &lt;chr&gt;,\n#   away_team &lt;chr&gt;, type &lt;chr&gt;, hit_location &lt;int&gt;, bb_type &lt;chr&gt;,\n#   balls &lt;int&gt;, strikes &lt;int&gt;, game_year &lt;int&gt;, pfx_x &lt;dbl&gt;, pfx_z &lt;dbl&gt;,\n#   plate_x &lt;dbl&gt;, plate_z &lt;dbl&gt;, on_3b &lt;int&gt;, on_2b &lt;int&gt;, on_1b &lt;int&gt;, …\n\n\n\n\n\n\n\n\nfull working script for plots at all 30 MLB ballparks\n\n\nDownloading: 2024-03-28 to 2024-04-30\n\n\nDownloading: 2024-05-01 to 2024-05-31\n\n\nDownloading: 2024-06-01 to 2024-06-30\n\n\nDownloading: 2024-07-01 to 2024-07-31\n\n\nDownloading: 2024-08-01 to 2024-08-31\n\n\nDownloading: 2024-09-01 to 2024-09-29"
  }
]